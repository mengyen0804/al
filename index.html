<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <title>🍓 采芝早餐 點餐系統・可愛融合版</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Noto Sans TC', sans-serif;
      background: linear-gradient(#fff7f0, #ffe6e6);
      padding: 30px;
      color: #4a3c3c;
      max-width: 800px;
      margin: auto;
    }
    h1 {
      text-align: center;
      font-size: 28px;
      color: #d44b79;
      background-color: #fff0f5;
      border-radius: 20px;
      padding: 15px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .section {
      background-color: #fff;
      border-radius: 16px;
      padding: 15px;
      margin-top: 20px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.1);
    }
    h2 {
      font-size: 20px;
      margin-bottom: 10px;
      color: #f27c9c;
    }
    .item {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
      margin: 8px 0;
    }
    .item label {
      flex: 1 1 60%;
    }
    .item input[type="number"],
    .item select {
      margin-left: 10px;
      flex: 0 0 auto;
    }
    input[type="text"], select, input[type="number"] {
      padding: 6px 10px;
      border: 1px solid #ccc;
      border-radius: 10px;
    }
    input[type="number"] {
      width: 50px;
    }
    button {
      background-color: #ff90b3;
      color: white;
      border: none;
      border-radius: 30px;
      padding: 10px 20px;
      font-size: 18px;
      cursor: pointer;
      display: block;
      margin: 20px auto;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }
    #total {
      text-align: center;
      font-size: 20px;
      font-weight: bold;
      color: #d44b79;
      margin-top: 15px;
    }
    #result {
      text-align: center;
      margin-top: 20px;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <h1>🍞 采芝早餐 點餐系統・可愛融合版 🧋</h1>
  <form id="orderForm">
    <div class="section">
      <label>👤 姓名：<input type="text" id="name" required /></label>
    </div>

    <div id="menu"></div>

    <div class="section">
      <label>📝 備註：<input type="text" id="note" placeholder="例如：少冰、加醬、不加蔥" /></label>
    </div>

    <div id="total">🍡 總金額：$0</div>
    <button type="submit">✨ 送出訂單 ✨</button>
    <p id="result"></p>
  </form>

  <script>
    const menuData = {
      "🍞 吐司類": {
        "草莓吐司": 20, "奶油吐司": 20, "花生吐司": 20, "巧克力吐司": 20,
        "吐司夾蛋": 30, "火腿蛋吐司": 40, "鮪魚蛋吐司": 45, "肉鬆蛋吐司": 45,
        "法國吐司": 50, "漢堡肉夾蛋吐司": 50
      },
      "🥪 厚片類": {
        "花生厚片": 35, "草莓厚片": 35, "奶油厚片": 35, "巧克力厚片": 35,
        "奶酥厚片": 40, "蒜味厚片": 40, "起司厚片": 40, "鮪魚厚片": 45
      },
      "🍙 飯糰 / 壽司類": {
        "特製素食飯糰": 45, "特製紫米飯糰": 50, "招牌紫米燒肉飯糰": 65
      },
      "🥗 三明治類": {
        "全麥素三明治": 30, "肉鬆三明治": 30, "鮪魚三明治": 30, "火腿三明治": 30,
        "起司水果三明治": 55, "鮪魚總匯三明治": 55, "招牌燒肉總匯三明治": 60
      },
      "🍳 蛋餅類": {
        "古早味羅蔔糕": 35, "原味蛋餅": 30, "青蔥蛋餅": 35, "芝麻蛋餅": 40,
        "火腿蛋餅": 40, "肉鬆蛋餅": 45, "鮪魚蛋餅": 45, "起司蛋餅": 45,
        "蔬菜蛋餅": 45, "玉米蛋餅": 45, "培根蛋餅": 50, "招牌燒肉蛋餅": 60
      },
      "🧋 飲料類": {
        "紅茶小": 20, "紅茶大": 40, "紅茶豆漿小": 20, "紅茶豆漿大": 40,
        "養生黃豆漿小": 20, "養生黃豆將大": 40, "養生黑豆漿小": 25, "養生黑豆漿大": 50,
        "山藥五穀米漿小": 25, "山藥五穀米漿大": 50, "鮮奶紅茶小": 25, "鮮奶紅茶大": 50,
        "咖啡牛奶小": 40, "咖啡牛奶大": 80
      }
    };

    const menuDiv = document.getElementById("menu");
    const totalDisplay = document.getElementById("total");

    function renderMenu() {
      for (const [category, items] of Object.entries(menuData)) {
        const section = document.createElement("div");
        section.className = "section";

        const title = document.createElement("h2");
        title.textContent = category;
        section.appendChild(title);

        for (const [item, price] of Object.entries(items)) {
          const wrapper = document.createElement("div");
          wrapper.className = "item";

          const label = document.createElement("label");
          label.textContent = `${item} - $${price}`;

          const quantity = document.createElement("input");
          quantity.type = "number";
          quantity.min = 0;
          quantity.max = 10;
          quantity.value = 0;
          quantity.setAttribute("data-price", price);
          quantity.setAttribute("data-item", item);
          quantity.addEventListener("change", updateTotal);

          wrapper.appendChild(label);
          wrapper.appendChild(quantity);

          if (category.includes("飲料")) {
            const select = document.createElement("select");
            select.innerHTML = `
              <option value="">選冰/溫</option>
              <option value="冰">冰</option>
              <option value="溫">溫</option>`;
            select.setAttribute("data-item", item);
            wrapper.appendChild(select);
          }

          section.appendChild(wrapper);
        }

        menuDiv.appendChild(section);
      }
    }

    function updateTotal() {
      let total = 0;
      document.querySelectorAll('input[type="number"]').forEach(input => {
        const qty = parseInt(input.value) || 0;
        const price = parseInt(input.getAttribute("data-price"));
        total += qty * price;
      });
      totalDisplay.textContent = `🍡 總金額：$${total}`;
    }

    renderMenu();

    document.getElementById("orderForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const name = document.getElementById("name").value;
      const note = document.getElementById("note").value;
      let total = 0;
      let order = [];

      document.querySelectorAll('input[type="number"]').forEach(input => {
        const qty = parseInt(input.value);
        if (qty > 0) {
          const item = input.getAttribute("data-item");
          const price = parseInt(input.getAttribute("data-price"));
          const parent = input.closest(".item");
          const select = parent.querySelector("select");
          const temp = select ? select.value : "";
          const label = temp ? `${item}（${temp}） x${qty} ($${price * qty})` : `${item} x${qty} ($${price * qty})`;
          order.push(label);
          total += qty * price;
        }
      });

      const res = await fetch("https://al.mengyen0804.workers.dev/", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name, note, order: order.join(", "), total })
      });

      const result = document.getElementById("result");
      if (res.ok) {
        result.textContent = "✅ 訂單送出成功！感謝光臨 ✨";
        document.getElementById("orderForm").reset();
        updateTotal();
      } else {
        result.textContent = "❌ 發送失敗，請再試一次 🙇‍♀️";
      }
    });
  </script>
</body>
</html>

