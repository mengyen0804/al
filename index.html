<!DOCTYPE html>
<html lang="zh-TW">
<head>
  
  <meta charset="UTF-8" />
  <title>é‡‡èŠæ—©é¤ é»é¤ç³»çµ± 3.0</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      
      max-width: 800px;
      margin: auto;
      padding: 20px;
      background: linear-gradient(to bottom, #fffbea, #fff5e1);
      color: #4a3c2f;
    }
    h1 {
      color: #ffffff;
      background-color: #f59e0b;
      padding: 20px;
      border-radius: 8px;
      text-align: center;
      font-weight: bold;
      font-size: 28px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
    }
    h2 {
      margin-top: 30px;
      background-color: #d4e9e2;
      color: #00704a;
      font-size: 20px;
      padding: 10px;
      border-radius: 6px;
      border-left: 6px solid #f59e0b;
    }
    .item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px;
      border-bottom: 1px solid #ccc;
    }
    .section {
      margin-bottom: 20px;
    }
    #total {
      font-weight: bold;
      margin-top: 20px;
      font-size: 22px;
      color: #ffffff;
      background-color: #00704a;
      padding: 12px;
      border-radius: 6px;
      text-align: center;
    }
    button {
      padding: 14px 28px;
      font-size: 16px;
      background-color: #00704a;
      color: #ffffff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      transition: background 0.3s ease;
    }
    button:hover {
      background-color: #1e3932;
    }
    button:hover {
      background-color: #eab308;
    }
    input[type="text"], select {
      font-size: 1.1em;
      padding: 4px 8px;
    }
    .controls {
      display: flex;
      gap: 10px;
      align-items: center;
    }
    input[type="number"] {
      width: 70px;
      font-size: 1.2em;
      padding: 4px 6px;
    }
  </style>
</head>
<body>
  <h1>â˜€ï¸ é‡‡èŠæ—©é¤ é»é¤ç³»çµ± 3.0</h1>
  <form id="orderForm">
    <label>ğŸ‘¤ å§“åï¼š
      <input type="text" id="name" required />
    </label>

    <div id="menu"></div>

    <label>ğŸ“ å‚™è¨»ï¼š
      <input type="text" id="note" placeholder="ä¾‹å¦‚ï¼šè¦åŠ è¾£æˆ–é†¬æ²¹" />
    </label>

    <div id="total">ç¸½é‡‘é¡ï¼š$0</div>

    <div class="section" id="preview" style="font-size: 2vw; line-height: 1.6; color: #5a5a5a; margin-top: 20px;">
      <strong>ğŸ›ï¸ æ‚¨ç›®å‰é¸æ“‡ï¼š</strong><br>
      <div id="previewList" style="max-height: 120px; overflow-y: auto; padding-right: 6px;"></div>
    </div>

    <button type="submit">é€å‡ºè¨‚å–® ğŸ›’</button>
  </form>

  <p id="result" style="margin-top: 20px; font-size: 1.2em; font-weight: bold; padding: 12px; text-align: center; border-radius: 8px; display: none;"></p>

  <script>
    const menuData = {
      "åå¸é¡": {
        "ğŸ“ è‰è“åå¸": 20, "ğŸ§ˆ å¥¶æ²¹åå¸": 20, "ğŸ¥œ èŠ±ç”Ÿåå¸": 20, "ğŸ« å·§å…‹åŠ›åå¸": 20,
        "ğŸ³ åå¸å¤¾è›‹": 30, "ğŸ¥© ç«è…¿è›‹åå¸": 40, "ğŸŸ é®ªé­šè›‹åå¸": 45, "ğŸ· è‚‰é¬†è›‹åå¸": 45,
        "ğŸ æ³•åœ‹åå¸": 50, "ğŸ” æ¼¢å ¡è‚‰å¤¾è›‹åå¸": 50
      },
      "åšç‰‡é¡": {
        "ğŸ¥œ èŠ±ç”Ÿåšç‰‡": 35, "ğŸ“ è‰è“åšç‰‡": 35, "ğŸ§ˆ å¥¶æ²¹åšç‰‡": 35, "ğŸ« å·§å…‹åŠ›åšç‰‡": 35,
        "ğŸ¥¯ å¥¶é…¥åšç‰‡": 40, "ğŸ§„ è’œå‘³åšç‰‡": 40, "ğŸ§€ èµ·å¸åšç‰‡": 40, "ğŸŸ é®ªé­šåšç‰‡": 45
      },
      "å£½å¸ / é£¯ç³°é¡": {
        "ğŸ· è‚‰é¬†å£½å¸": 0, "ğŸŸ é®ªé­šå£½å¸": 0, "ğŸ¥¬ ç´ é£Ÿå£½å¸": 0, "ğŸŒ¸ ç‰¹è£½èŠ±å£½å¸": 0,
        "ğŸ¥¬ ç‰¹è£½ç´ é£Ÿé£¯ç³°": 45, "ğŸ™ ç‰¹è£½ç´«ç±³é£¯ç³°": 50, "ğŸ”¥ æ‹›ç‰Œç´«ç±³ç‡’è‚‰é£¯ç³°": 65
      },
      "ä¸‰æ˜æ²»é¡": {
        "ğŸ¥¬ å…¨éº¥ç´ ä¸‰æ˜æ²»": 30, "ğŸ· è‚‰é¬†ä¸‰æ˜æ²»": 30, "ğŸŸ é®ªé­šä¸‰æ˜æ²»": 30, "ğŸ¥© ç«è…¿ä¸‰æ˜æ²»": 30,
        "ğŸ“ èµ·å¸æ°´æœä¸‰æ˜æ²»": 55, "ğŸŸ é®ªé­šç¸½åŒ¯ä¸‰æ˜æ²»": 55, "ğŸ”¥ æ‹›ç‰Œç‡’è‚‰ç¸½åŒ¯ä¸‰æ˜æ²»": 60
      },
      "è›‹é¤…é¡": {
        "ğŸ§ å¤æ—©å‘³ç¾…è””ç³•": 35, "ğŸ³ åŸå‘³è›‹é¤…": 30, "ğŸ§… é’è”¥è›‹é¤…": 35, "âš« èŠéº»è›‹é¤…": 40,
        "ğŸ¥© ç«è…¿è›‹é¤…": 40, "ğŸ· è‚‰é¬†è›‹é¤…": 45, "ğŸŸ é®ªé­šè›‹é¤…": 45, "ğŸ§€ èµ·å¸è›‹é¤…": 45,
        "ğŸ¥¬ è”¬èœè›‹é¤…": 45, "ğŸŒ½ ç‰ç±³è›‹é¤…": 45, "ğŸ¥“ åŸ¹æ ¹è›‹é¤…": 50, "ğŸ”¥ æ‹›ç‰Œç‡’è‚‰è›‹é¤…": 60
      },
      "é£²æ–™é¡": {
        "ğŸµ ç´…èŒ¶å°": 20, "ğŸµ ç´…èŒ¶å¤§": 40, "ğŸ¥¤ ç´…èŒ¶è±†æ¼¿å°": 20, "ğŸ¥¤ ç´…èŒ¶è±†æ¼¿å¤§": 40,
        "ğŸŸ¡ é¤Šç”Ÿé»ƒè±†æ¼¿å°": 20, "ğŸŸ¡ é¤Šç”Ÿé»ƒè±†å°‡å¤§": 40, "âš« é¤Šç”Ÿé»‘è±†æ¼¿å°": 25, "âš« é¤Šç”Ÿé»‘è±†æ¼¿å¤§": 50,
        "ğŸŒ¾ å±±è—¥äº”ç©€ç±³æ¼¿å°": 25, "ğŸŒ¾ å±±è—¥äº”ç©€ç±³æ¼¿å¤§": 50, "ğŸ¥› é®®å¥¶ç´…èŒ¶å°": 25, "ğŸ¥› é®®å¥¶ç´…èŒ¶å¤§": 50,
        "â˜• å’–å•¡ç‰›å¥¶å°": 40, "â˜• å’–å•¡ç‰›å¥¶å¤§": 80
      }
    };

    const menuDiv = document.getElementById("menu");
    const totalDisplay = document.getElementById("total");

    function renderMenu() {
      for (const [category, items] of Object.entries(menuData)) {
        const section = document.createElement("div");
        section.className = "section";
        const title = document.createElement("h2");
        title.textContent = category;
        section.appendChild(title);

        for (const [item, price] of Object.entries(items)) {
          const wrapper = document.createElement("div");
          wrapper.className = "item";

          const label = document.createElement("label");
          label.textContent = `${item} - $${price}`;
          label.style.fontWeight = "bold";
          label.style.fontSize = "clamp(16px, 4.5vw, 22px)";

          const controls = document.createElement("div");
          controls.className = "controls";

          const quantityInput = document.createElement("input");
          quantityInput.type = "number";
          quantityInput.min = 0;
          quantityInput.max = 10;
          quantityInput.value = 0;
          quantityInput.setAttribute("data-price", price);
          quantityInput.setAttribute("data-item", item);
          quantityInput.addEventListener("change", updateTotal);

          controls.appendChild(quantityInput);

          if (category === "é£²æ–™é¡") {
            const tempSelect = document.createElement("select");
            tempSelect.innerHTML = `
              <option value="">é¸å†°/æº«</option>
              <option value="å†°">å†°</option>
              <option value="æº«">æº«</option>`;
            tempSelect.setAttribute("data-item", item);
            controls.appendChild(tempSelect);
          }

          wrapper.appendChild(label);
          wrapper.appendChild(controls);
          section.appendChild(wrapper);
        }

        menuDiv.appendChild(section);
      }
    }

    function updateTotal() {
      let total = 0;
      const preview = document.getElementById("previewList");
      let lines = [];
      document.querySelectorAll('input[type="number"]').forEach(input => {
        const qty = parseInt(input.value) || 0;
        const price = parseInt(input.getAttribute("data-price")) || 0;
        const item = input.getAttribute("data-item");
        if (qty > 0) {
          total += qty * price;
          const parent = input.closest(".item");
          const select = parent.querySelector("select");
          const temp = select && select.value ? `ï¼ˆ${select.value}ï¼‰` : "";
          lines.push(`${item}${temp} x${qty}ï¼ˆ$${price * qty}ï¼‰`);
        }
      });
      totalDisplay.textContent = `ç¸½é‡‘é¡ï¼š$${total}`;
      preview.innerHTML = lines.length
        ? lines.map((line, index) => `<div>${line} <button type='button' onclick='removeItem(${index})' style='margin-left: 8px; background: none; border: none; color: red; font-weight: bold; cursor: pointer;'>âœ•</button></div>`).join("")
        : "ï¼ˆå°šæœªé¸æ“‡é¤é»ï¼‰";
    }

    renderMenu();

    const form = document.getElementById("orderForm");
    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const name = document.getElementById("name").value;
      const note = document.getElementById("note").value;

      let orders = [];
      let total = 0;

      document.querySelectorAll('input[type="number"]').forEach(input => {
        const qty = parseInt(input.value);
        if (qty > 0) {
          const item = input.getAttribute("data-item");
          const price = parseInt(input.getAttribute("data-price"));
          const parent = input.closest(".item");
          const select = parent.querySelector("select");
          const temp = select ? select.value : "";
          const label = temp ? `${item}ï¼ˆ${temp}ï¼‰ x${qty} ($${price * qty})` : `${item} x${qty} ($${price * qty})`;
          orders.push(label);
          total += price * qty;
        }
      });

      const res = await fetch("https://al.mengyen0804.workers.dev/", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name, order: orders.join(", "), note, total })
      });

      if (res.ok) {
        const resultEl = document.getElementById("result");
        resultEl.textContent = "âœ… è¨‚å–®é€å‡ºæˆåŠŸï¼";
        resultEl.style.backgroundColor = "#d1fae5";
        resultEl.style.color = "#065f46";
        resultEl.style.display = "block";
        form.reset();
        updateTotal();
      } else {
        const resultEl = document.getElementById("result");
        resultEl.textContent = "âŒ ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚";
        resultEl.style.backgroundColor = "#fee2e2";
        resultEl.style.color = "#991b1b";
        resultEl.style.display = "block";
      }
    });
  function removeItem(index) {
      const inputs = Array.from(document.querySelectorAll('input[type="number"]'));
      let counter = 0;
      for (const input of inputs) {
        const qty = parseInt(input.value);
        if (qty > 0) {
          if (counter === index) {
            input.value = 0;
            updateTotal();
            break;
          }
          counter++;
        }
      }
    }
  </script>
</body>
</html>
